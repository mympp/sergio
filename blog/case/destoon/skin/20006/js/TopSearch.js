var searchText;var request=false;function Search(A){var B=document.getElementById(A).value;if(B!=searchText&&B!=""){ClearTable();searchText=B;GetData(A)}else{if(B!=searchText&&B==""){searchText=B;HideDiv()}}}function GetData(valid){CreateAjax();if(request){var url="/Ajax/Search.ashx?t="+Math.random();request.open("post",url,true);request.setRequestHeader("Content-Type","application/x-www-form-urlencoded");request.onreadystatechange=function(){if(request.readyState==4&&request.status==200){var response=request.responseText;response=eval("("+response+")");var resultdiv=document.getElementById("resultdiv");if(response.result.length>0){resultdiv.style.display="";var resulttable=document.getElementById("resulttable");var div=document.createElement("div");div.className="search_combox";var ul=document.createElement("ul");var i=0;for(i=0;i<response.result.length;i++){var li=document.createElement("li");if(response.result[i].tag=="0"){var sapn=document.createElement("span");var em=document.createElement("em");sapn.innerHTML=response.result[i].keyword;li.appendChild(sapn);em.innerHTML="相关信息约"+response.result[i].clickNum+"条";li.appendChild(em);ul.appendChild(li)}else{var ul2=document.createElement("ul");var li2=document.createElement("li");li2.innerHTML=response.result[i].clickNum.replace("：",":").replace("『","[").replace("』","]").replace("【","{").replace("】","}").replace("：",":");ul2.appendChild(li2);div.appendChild(ul2);i=6;}li.onmouseover=function(){this.className="selectOver"};li.onmouseout=function(){this.className="select"};li.onclick=function(){document.getElementById(valid).value=this.childNodes[0].innerHTML;ClearTable()}}resulttable.appendChild(ul);if(i>5){resulttable.appendChild(div)}}}else{HideDiv()}};request.send("keyword="+searchText)}}function ClearTable(){var A=document.getElementById("resulttable");var B=A.childNodes;if(B.length>0){for(i=0;i<B.length;i++){A.removeChild(B[i]);i=i-1}}HideDiv()}function Wait(){if(document.activeElement.id=="resulttable"){return false}else{ClearTable()}}function HideDiv(){var A=document.getElementById("resultdiv");A.style.display="none"}function CreateAjax(){if(window.XMLHttpRequest){request=new XMLHttpRequest();if(request.overrideMimeType){request.overrideMimeType="text/xml"}}else{if(window.ActiveXObject){try{request=new ActiveXObject("Msxml2.XMLHTTP")}catch(A){try{request=new ActiveXObject("Microsoft.XMLHTTP")}catch(B){request=false}}}}return request};