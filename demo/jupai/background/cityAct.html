
<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="csrf-token" content="I9VnGhpb1YFgTJPiLA7u89h73Ps15wcxGo4Lhguy" />
<meta name="renderer" content="webkit">
<meta name="description" content="聚派科技，国内首家移动场景营销广告平台。广告sdk流量变现联盟，ios、android广告插件sdk，新型互联网app流量变现模式；场景营销广告联盟，cpa cpm cpc cps cpt等。聚派-简单连接一切，开启智慧生活。">
<meta name="keywords" content="流量变现、app流量变现、广告sdk、sdk广告、场景营销、cpm广告联盟、app广告联盟、广告联盟">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=IE8">
<title>聚派-SDK-城市管理</title>
<link rel="stylesheet" href="/css/metisMenu.min.css">
<link href="/css/city-picker.css" rel="stylesheet" type="text/css" />
<link rel="stylesheet" href="css/index.css">
</head>
<body>
	<div id="wrapper">
    
				<!-- 右侧 -->
		<div class="content_wrap" style="margin-left:0;">
			<div class="content">
    <div class="container custom-edit-container clearfix">
        <!-- <h5><span><a href="http://www.soundtooth.cn/childAccountList">客户列表</a>&nbsp;&gt;&gt;&nbsp;编辑</span></h5> -->
        <div class="vital-row-box">
            <!-- <div class="vital-row cityId">
                <span class="left">*城市ID:</span>
                <input type="text" maxlength="128" id="cityId" placeholder="城市ID" autocomplete="off">
                
            </div> -->

            <div class="vital-row cityId">
                <span class="left">城市ID:</span>
                <input type="text" maxlength="256" id="cityId" placeholder="城市ID" autocomplete="off">
                <span class="tips"></span>
            </div>
            <div class="vital-row cityName">
                <span class="left">城市名:</span>
                <input type="text" maxlength="256" id="cityName" placeholder="城市名" autocomplete="off">
                <span class="tips"></span>
            </div>
            
            
             <div class="vital-row provinceCode">
                <span class="left">*省份:</span>
                <div class="select-city">
                    <select id="provinceId"></select>
                </div>
            </div>
            <!-- <div class="vital-row cityCode">
                <span class="left">*城市:</span>
                <select id="cityCode">
                    
                </select>
                <input type="hidden" name="city" id="city">
                <span class="tips"></span>
            </div>
           
           
            <div class="vital-row serverPhone">
                <span class="left">*服务热线:</span>
                <input type="text" maxlength="64" id="serverPhone" placeholder="请输入服务热线">
                <span class="tips">建议输入业务负责人的电话</span>
            </div>
            <div class="vital-row salePhone">
                <span class="left">*销售热线:</span>
                <input type="text" maxlength="64" id="salePhone" placeholder="请输入销售热线">
                <span class="tips">请输入店销售电话</span>
            </div>
             <div class="vital-row address">
                <span class="left">*地址:</span>
                <input type="text" maxlength="256" id="address" placeholder="">
                <span class="tips"></span>
            </div>
            <div class="vital-row email">
                <span class="left">邮箱:</span>
                <input type="text" maxlength="256" id="email" placeholder="">
                <span class="tips"></span>
            </div> -->
            <div class="vital-row role">
                
            </div>
          

        </div>
        <button id="submit-button">确定</button>
    </div>
</div>

			
		</div>
	</div>
	<div class="loading-area">
		<div class="loading-mask"></div>
		<div class="loading-icon"></div>
	</div>
	<!--[if !IE]> -->
	<script src="/js/jquery-2.1.4.min.js"></script>
	<!-- <![endif]-->
	<!--[if IE]>
	<script src="/js/jquery-1.11.3.min.js"></script>
	<![endif]-->
	<script src="/background/js/metisMenu.js"></script>
	<script>
		$(function() {
			 $('#menu').metisMenu({
				toggle: false
			});
		});
	</script>
	<script type="text/javascript">
	$(document).ready(function(){
		$(".post_content a[href='"+window.location.href+"']").addClass("selflink")
		$('.selflink').click(function() {return false;});
		$.fn.scrollFollow=function(options){options=options||{};options.container=options.container||$(this).parent();options.bottomObj=options.bottomObj||'';options.bottomMargin=options.bottomMargin||0;options.marginTop=options.marginTop||0;options.marginBottom=options.marginBottom||0;$window=$(window),$scrollObj=$(this);if($scrollObj.length<=0){return}scrollObj_Top=$scrollObj.position().top,scrollObj_Container_Height=options.container.height(),scrollObj_Position=$scrollObj.css("position");if(options.bottomObj==''||$(options.bottomObj).length<=0){is_bottomObj_exists=false}else{is_bottomObj_exists=true}$window.scroll(function(event){var new_scrollObj_Container_Height=options.container.height();var scrollObj_Height=$scrollObj.height();if(scrollObj_Container_Height!=new_scrollObj_Container_Height&&scrollObj_Container_Height<new_scrollObj_Container_Height+scrollObj_Height){scrollObj_Top=$scrollObj.position().top;scrollObj_Container_Height=new_scrollObj_Container_Height}scrollTop=$window.scrollTop(),topPosition=Math.max(0,scrollObj_Top-scrollTop);if(is_bottomObj_exists==true){var bottomObj_Top=$(options.bottomObj).position().top-options.marginBottom-options.marginTop;topPosition=Math.min(topPosition,(bottomObj_Top-scrollTop)-scrollObj_Height)}if(scrollTop>scrollObj_Top){if(is_bottomObj_exists==true&&(scrollObj_Top+scrollObj_Height>bottomObj_Top)){$scrollObj.css({position:scrollObj_Position,top:scrollObj_Top})}else{if(window.XMLHttpRequest){$scrollObj.css({position:"fixed",top:topPosition+options.marginTop})}else{$scrollObj.css({position:"absolute",top:scrollTop+topPosition+options.marginTop+'px'})}}}else{$scrollObj.css({position:scrollObj_Position,top:scrollObj_Top})}})};
		$(".sidebar").scrollFollow({
			bottomObj: '.footer',
			marginTop: 0,
			marginBottom: 2
		});

	});
	</script>
	<script src="/background/js/bootstrap.min.js"></script>
<script src="/js/city-picker.data.js"></script>
<script src="/js/city-picker.js"></script>
<script type="text/javascript" src="/background/js/custom.js"></script>
<script type="text/javascript" src="/js/layer.js"></script>
<script type="text/javascript" src="/js/datas/province.js"></script>
<script type="text/javascript" src="/js/datas/cities.js"></script>
<script type="text/javascript">
$("#role   option[value='2']").attr("selected",true);
var posturl = "";
var tip="";
$(document).ready(function() {
    $.each(province,function(i,v){
        $("#provinceId").append('<option value=\''+v.provinceId+'\'>'+v.provinceName+'</option>')
    });
    

        if(getParam("cityId")){
            posturl="/background/cityUpdate.do";
            tip="修改";
             $("#cityId").val(getParam("cityId"));
             $.ajax({
                    url: '/background/getcity.do?cityId='+$("#cityId").val(),
                    type: 'get',
                    dataType: 'json'
                   
                })
                .done(function(json) {
                    console.log("success");
                    console.log(json);
                    if(json.errCode=='200'){
                        $("#cityId").val(json.data.cityId);
                        $("#cityName").val(json.data.cityName);
                       
                        $("#provinceId").val(json.data.provinceId);
                       
                       
                        
                       

                       
                       
                    }else{
                        layer.alert(json.errMsg);
                    }
                })
                .fail(function() {
                    console.log("error");
                })
                .always(function() {
                    console.log("complete");
                });
            }else{
                
                posturl="/background/cityAdd.do";
                tip="添加";
            }

            $("#submit-button").click(function(event){
                event.preventDefault();
               
                if ($("#cityId").val().trim()=='') {
                    layer.msg('城市ID不能为空', {icon: 5,time: 2000});
                    return;
                }
                if ($("#cityName").val().trim()=='') {
                    layer.msg('城市名不能为空', {icon: 5,time: 2000});
                    return;
                }
                if ($("#provinceId").val().trim()=='') {
                    layer.msg('省份不能为空', {icon: 5,time: 2000});
                    return;
                }
               
                $.ajax({
                    url: posturl,
                    type: 'post',
                    dataType: 'json',
                    async:false,
                    data: {
                        cityId:$("#cityId").val(),
                        cityName:$("#cityName").val(),
                        provinceId:$("#provinceId").val(),
                        
                    }
                })
                .done(function(json) {
                    console.log("success");
                    console.log(json);
                    if(json.errCode=='200'){
                        layer.alert(tip+"专营店成功",function(){

                             window.location.reload();

                        });
                        // layer.msg(tip+"专营店成功", {icon: 5,time: 2000});
                       
                    }else{
                        layer.alert(json.errMsg);
                    }
                })
                .fail(function() {
                    console.log("error");
                })
                .always(function() {
                    console.log("complete");
                });
            });
       
});

function getParam(paramName) {
            paramValue = "";
            isFound = false;
            //alert(location.href);
            if (this.location.search.indexOf("?") == 0 && this.location.search.indexOf("=") > 1) {
                arrSource = unescape(this.location.search).substring(1, this.location.search.length).split("&");
                i = 0;
                while (i < arrSource.length && !isFound) {
                    if (arrSource[i].indexOf("=") > 0) {
                        if (arrSource[i].split("=")[0].toLowerCase() == paramName.toLowerCase()) {
                            paramValue = arrSource[i].split("=")[1];
                            isFound = true;
                        }
                    }
                    i++;
                }
            }
            return paramValue;
        }


</script>
</body>
</html>
