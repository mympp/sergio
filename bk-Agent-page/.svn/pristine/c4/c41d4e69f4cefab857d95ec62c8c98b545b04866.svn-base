<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>发布公告</title>
    <link rel="stylesheet" href="STYLE_DOMAIN/Agent/css/common.css" />
    <link rel="stylesheet" href="STYLE_DOMAIN/Agent/css/index.css" />
    <link rel="stylesheet" type="text/css" href="STYLE_DOMAIN/Agent/css/set.css">
    <script type="text/javascript" src="http://<?php echo $_SERVER['SERVER_NAME'];?>/Public/Agent/RichTextEdit/ueditor.config.js"></script>
    <script type="text/javascript" src="http://<?php echo $_SERVER['SERVER_NAME'];?>/Public/Agent/RichTextEdit/ueditor.all.js"> </script>
    <script type="text/javascript" src="http://<?php echo $_SERVER['SERVER_NAME'];?>/Public/Agent/RichTextEdit/lang/zh-cn/zh-cn.js"></script>

</head>
<body style="min-width: 1280px;">
<!--父容器开始-->
<div class="outer_div">
    <div class="left_template">
       <include file="Common:left_nav"/>
    </div>
    <div class="right_template">
        <include file="Common:right_nav"/>
    </div>
    <div class=" page-set white-bg set-send">
        <h2>发布公告</h2>
        <!-- 发送信息表格开始 -->
        <form class="consult-form">
            <span><i>*</i>公告标题：</span><input type="text" class="input_cell1" placeholder="请输入公告标题" name="title"><br />
            <span style="vertical-align: top;width: 139px;"><i>*</i>公告内容：</span>
            <!--<iframe style="margin-top: 3px;" id="Baidu_editor" src="STYLE_DOMAIN/Agent/RichTextEdit/index.html" frameborder="0" scrolling="no" width="750px" height="500px"></iframe>-->
            <div class="editor-box"><script id="editor" type="text/plain"></script></div>
            <br/>
            <span><i>*</i>发布时间：</span>
            <div class="laydate-div">
                <input type="text" class="input_cell_sm1 date_icon_1" id="expiration_time" placeholder="请选择发布时间"/><label for="expiration_time"></label>
            </div>
            
            <br/>
            <div class="btn-box set-send-btn">
                <input type="button" value="确认" class="setSendSub blue-btn">
                <input type="button" value="清空" class="allClean white-btn">
            </div>
        </form>
        <!-- 发送信息表格结束 -->
        <!-- 模拟弹窗开始 -->
        <div class="moni-box" style="display: none;"></div>
        <!-- 清空按钮 -->
        <div class="send-clean moni-lbox" style="display: none;">
            <p>确认清空？</p>
            <div class="btn-box">
                <input type="button" value="确认" name="remove" class="closesubmit blue-btn">
                <input type="button" value="取消" name="cancel" class="cancel white-btn">
            </div>
        </div>
        <!-- 模拟弹窗结束 -->
    </div>
</div>
<!--父容器结束-->
<script>var pages = "系统设置";var index1 = 4; var index2 = 1;</script>
<script src="STYLE_DOMAIN/Agent/js/jquery.js"></script>
<script src="STYLE_DOMAIN/Agent/js/common.js"></script>
<script src="STYLE_DOMAIN/Agent/js/laydate/laydate.js"></script>
<script src="STYLE_DOMAIN/Agent/js/set.js"></script>
<script>
    var show_notice = "{:U('Setting/show_notice')}";
    //发布公告富文本编辑器和发布时间
    $(function(){
        var ue = UE.getEditor('editor');//富文本编辑器
        laydate.render({//发布时间
          elem: '#expiration_time', //指定元素
          type: 'datetime'
        });
    })
    //后台提交
    $(document).on("click",".setSendSub",function(){
        var sendTitle = $("input[name=title]").val();//获得公告标题
        var editHtml = $("#editor").find("#ueditor_0").contents().find("body").html();//获得富文本编辑器的html片段
        var sendTime = $("#expiration_time").val();
        if (sendTitle == "" || sendTitle == undefined){
            alert("请输入正确的公告标题");
        } else if (editHtml == "<p><br></p>" || editHtml == "<p></p>" || editHtml == undefined){
            alert("请输入正确的公告内容");
        } else if (sendTime == "" || sendTime == undefined) {
            alert("请输入正确的发布时间");
        } else {
            var data = {'title':sendTitle,'conten':editHtml,'time':sendTime};
            $.post(show_notice,data,function(data){
                if(data.code != 1){
                    alert(data.message);
                }else{
                    alert(data.message);
                    window.location.href='set-history.html';
                }
            },'json');
        }
    })


</script>
</body>
</html>
