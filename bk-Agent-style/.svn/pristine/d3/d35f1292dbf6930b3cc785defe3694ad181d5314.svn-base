/*
公共js
 */
    //动态获取高度
    $(function(){
        $(window).on("load",function(){
            getHeight();//设置动态高度
            // setTimeout(function(){
            //     $(".icon-shopping").eq(1).addClass("active").siblings().removeClass("active");
            //     $(".icon-person-div").css("display","block").find("p").eq(0).addClass("open");
            // },100);
        })
        
        $(window).resize(function(){
            getHeight();//设置动态高度
        });
    })
    //定义获取高度方法
    function getHeight(){
        var winH = $(window).height();
        var topH = $(".left_header").height();
        var editorHeight = $("#editor").height();
        $(".left_template").height(winH);
        $(".outer_div").height(winH);
        $(".page-set").height(winH-162);
        $(".white-bg").height(winH-102);
        $(".user-bbox").height(winH-295);
        $("#edui1_iframeholder").height(editorHeight-33);
        //console.log(winH-topH);
    }
/*
系统设置页面
 */  
    // 虚拟弹窗交互
    $(".removeBtn").click(function(){
        $(".remove-box,.moni-box").fadeIn();
    })
    // 用户组
    $(".addUser").click(function(){
    	$(".user-main").hide();
    	$(".add-user").fadeIn();
    })
    $(".userRedact").click(function(){
        $(".user-main").hide();
        $(".add-user").fadeIn();
    })
    // 发布公告
    $(".allClean").click(function(){
        var title = $(".consult-form input[type=text]").val();
        var editHtml = $("#editor").find("#ueditor_0").contents().find("body").html();//获得富文本编辑器的html片段
        if (title == "" && editHtml == "<p><br></p>" && editHtml == "<p></p>") {
            alert("公告标题或公告内容已经为空了。")
        } else {
        	$(".send-clean,.moni-box").fadeIn();
        }
    })
    //公告历史
    $(".hisRedact").click(function(){
        $(".his-redact,.moni-box").fadeIn();
    })
    $(".hisDetails").click(function(){
        $(".his-details,.moni-box").fadeIn();
    })

    
    //关闭所有虚拟弹窗
    var allClean = $(".closeAll").parent().parent();
    $(".closeAll,.cancel").click(function(){
        $(allClean).hide();
        $(".moni-box,.moni-lbox").fadeOut();
        $(".user-main").fadeIn();
    })
    //清空
    $(".closesubmit").click(function(){
        $(".consult-form input[type=text]").val("");
        $(".moni-box,.send-clean").fadeOut();
        $("#editor").find("#ueditor_0").contents().find("body").empty();//
        var editorHeight = $("#editor").height();
        $("#edui1_iframeholder").height(editorHeight-33);
    })

    
/*
新增用户编辑用户页面
 */
    //选择父选项全选子选项
    $(".input-head").click(function(){
        $(this).each(function(){
            if ($(this).prop("checked")) {
                //全选按钮选中
                $(this).parent().next().children().children().prop("checked",true);
            } else {
                //全选按钮没选中
                $(this).parent().next().children().children().prop("checked",false);
            }
        })
    })
    //子选项打钩的情况下父选项必须打钩。
    var inputChild = $(".input-head").parent().next().children().children();
    $(inputChild).each(function(){
        $(this).click(function(){
            var inputParent = $(this).parent().parent().prev().children();
            if ($(inputParent).prop("checked") == false) {
                $(inputParent).prop("checked",true);
            }
            // 子选项不选的情况下父选项不打勾
            // if ($(this).prop("checked") == false){
            //       $(this).parent().parent().prev().children().prop("checked",false);
            // }
        })
    })
    

/*
发布公告页面
 */
    //发布公告富文本编辑器和发布时间
    $(function(){
        var ue = UE.getEditor('editor');//富文本编辑器
        laydate.render({//发布时间
          elem: '#expiration_time', //指定元素
          type: 'datetime'
        });
    })
